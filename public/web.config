<configuration>
    <system.webServer>
        <staticContent>
            <clientCache cacheControlCustom="public" cacheControlMode="UseMaxAge" cacheControlMaxAge="365.00:00:00" />
            <remove fileExtension=".woff" />
            <remove fileExtension=".woff2" />
            <mimeMap fileExtension=".woff" mimeType="application/x-font-woff" />
            <mimeMap fileExtension=".woff2" mimeType="application/font-woff2" />
        </staticContent>
        <httpProtocol>
            <customHeaders>
                <add name="Access-Control-Allow-Origin" value="*" />
                <add name="Access-Control-Allow-Headers" value="*" />
                <remove name="X-Powered-By" />
                <add name="Feature-Policy" value="
                    autoplay 'none';
                    camera 'none';
                    encrypted-media 'none';
                    fullscreen 'none';
                    geolocation 'none';
                    microphone 'none';
                    midi 'none';
                    payment 'none';
                    vr 'none';
                    " />
                <add name="Referrer-Policy" value="no-referrer" />
                <add name="X-Frame-Options" value="sameorigin" />
                <add name="X-Xss-Protection" value="1; mode=block" />
                <add name="X-Content-Type-Options" value="nosniff" />
                <add name="Content-Security-Policy" value="
                    script-src
                        'self'
                        https://www.googletagmanager.com
                        https://www.google-analytics.com
                        https://ajax.googleapis.com
                        https://cdnjs.cloudflare.com
                        https://eum.instana.io ;
                    style-src 'unsafe-inline' *;
                    " />
            </customHeaders>
        </httpProtocol>
        <rewrite>
            <rules>
                <rule name="Remove trailing slash" stopProcessing="false">
                    <match url="(.*)/$" />
                    <conditions>
                        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                    </conditions>
                    <action type="Redirect" url="{R:1}" />
                </rule>
                <rule name="Rewrite Requests To Public" stopProcessing="true">
                    <match url="^(.*)$" ignoreCase="false" />
                    <conditions logicalGrouping="MatchAll">
                        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                    </conditions>
                    <action type="Rewrite" url="/index.php/{R:1}" appendQueryString="true" />
                </rule>
            </rules>
            <outboundRules>
                <rule name="Add Strict-Transport-Security when HTTPS" enabled="true">
                    <match serverVariable="RESPONSE_Strict_Transport_Security" pattern=".*" />
                    <conditions>
                        <add input="{HTTPS}" pattern="on" ignoreCase="true" />
                    </conditions>
                    <action type="Rewrite" value="max-age=31536000" />
                </rule>
            </outboundRules>
        </rewrite>
        <validation validateIntegratedModeConfiguration="false" />
        <modules runAllManagedModulesForAllRequests="true"/>
        <handlers>
            <add name="DenyOTH" verb="OPTION,TRACE,HEAD" path="*" type="System.Web.HttpMethodNotAllowedHandler" />
            <remove name="OPTIONSVerbHandler" />
            <remove name="PHP72_via_FastCGI" />
            <add name="PHP72_via_FastCGI" path="*.php" verb="GET,POST,DELETE" modules="FastCgiModule" scriptProcessor="D:\Program Files (x86)\PHP\v7.2\php-cgi.exe" resourceType="Either" />
        </handlers>
        <security>
            <requestFiltering removeServerHeader="true">
                <verbs allowUnlisted="false">
                    <add verb="GET" allowed="true" />
                    <add verb="POST" allowed="true" />
                    <add verb="DELETE" allowed="true" />
                </verbs>
            </requestFiltering>
        </security>
    </system.webServer>
</configuration>
